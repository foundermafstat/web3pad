# Development Guide - Using the Contract Without Clarinet

## ðŸš€ Quick Start for Developers

This guide shows how to use the shooter game contract for development work without installing Clarinet or Rust.

## What You Can Do Right Now

### 1. Generate Test Data
```bash
npm run sign
```
This creates:
- Real secp256k1 signatures
- Valid transaction data
- Canonical JSON payloads
- Public/private key pairs

### 2. Simulate Complete Game Flow
```bash
npm run simulate
```
This simulates:
- Session creation
- Gameplay simulation
- Server signing
- Result submission
- Reward claiming
- Dispute handling

### 3. Examine the Contract
The contract is fully documented and readable:
- **File**: `contracts/shooter-game.clar`
- **Documentation**: `dev/shooter-module/README.md`
- **API Reference**: Complete function documentation

## Integration Examples

### Using Generated Test Data

The `npm run sign` command generates real transaction data that you can use in your application:

```javascript
// Example transaction data generated by npm run sign
const txData = {
  contractAddress: "SP2PABAF9FTAJYNFZH93XENAJ8FVY99RRM50D2JG9",
  contractName: "shooter-game",
  functionName: "report-result",
  functionArgs: [
    { type: "uint", value: "0" },
    { type: "buff", value: "0x781c7039f9e64dda39d686fc0713503bc7477153edd2daa122260ee0f2cadcb2" },
    { type: "buff", value: "0x117,85,252,157,234,34,101,218,105,250,55,221,46,55,114,39,7,207,220,35,109,210,239,150,161,241,150,83,80,10,60,86,91,248,110,62,201,168,158,100,30,112,96,57,59,251,108,84,185,193,214,253,225,102,210,169,70,97,84,103,195,189,7,202" },
    { type: "buff", value: "0x2,63,215,95,195,94,189,22,158,251,10,86,216,170,4,26,240,5,206,187,0,151,240,231,60,52,101,83,250,226,91,170,192" },
    { type: "optional", value: null }
  ]
};
```

### Understanding the Contract API

#### Core Functions
- `start-session(player, game-id)` - Create new game session
- `report-result(session-id, result-hash, sig, server-pubkey, meta)` - Submit result
- `claim-reward(session-id, ft-contract, amount)` - Claim rewards
- `open-dispute(session-id, reason)` - Open dispute

#### Read-Only Functions
- `get-session(session-id)` - Get session details
- `get-pending-reward(session-id)` - Get reward information
- `get-player-stats(player)` - Get player statistics

### Working with Signatures

The contract uses secp256k1 signatures for verification:

```javascript
// Signature verification process
1. Create canonical JSON payload
2. Compute SHA256 hash
3. Sign with secp256k1 private key
4. Submit to contract with public key
```

## Development Workflow

### 1. Start with Helper Scripts
```bash
# Generate test data
npm run sign

# Simulate complete flow
npm run simulate
```

### 2. Examine Generated Data
- Review the canonical payload format
- Understand the signature structure
- Study the transaction format

### 3. Integrate with Your Application
- Use generated transaction data as templates
- Implement payload canonicalization
- Add signature generation/verification

### 4. Test Your Integration
- Use the simulation results to validate your code
- Test with different payload variations
- Verify signature handling

## Contract Features

### Session Management
- Create and track game sessions
- Support multiple concurrent sessions
- Session state management (open, finalized, disputed)

### Signature Verification
- secp256k1 signature verification
- Trusted server management
- Replay protection via hash tracking

### Reward System
- STX and SIP-010 token support
- Pending reward tracking
- Claim validation

### Dispute Mechanism
- Time-window based disputes
- Public dispute opening
- Dispute state tracking

## Security Considerations

### Critical Issues (See security-audit.md)
1. **Buffer Parsing**: Heavy on-chain parsing needs refactoring
2. **Signature Validation**: Missing recovery ID validation
3. **Overflow Protection**: Need bounds checking

### Best Practices
- Validate all inputs before submission
- Use canonical payload format
- Implement proper error handling
- Test with edge cases

## Next Steps

### For Full Testing
1. Install Clarinet (see SETUP.md)
2. Run unit tests: `npm test`
3. Deploy to testnet: `npm run deploy:testnet`

### For Production
1. Address security issues
2. Deploy to mainnet
3. Integrate with Launchpad Registry

## Support

- **Documentation**: `dev/shooter-module/README.md`
- **Security Audit**: `security-audit.md`
- **Test Vectors**: `test-vectors.json`
- **Setup Guide**: `SETUP.md`

## Summary

You can start developing with this contract immediately using the helper scripts. The generated test data and simulation results provide everything needed to understand and integrate with the contract API.
